{{/*
Copyright 2019-present Facebook Inc. All rights reserved.
This source code is licensed under the Apache 2.0 license found
in the LICENSE file in the root directory of this source tree.
*/}}

{{ define "dbschema" }}

{{ with extend $ "Package" "dbschema" -}}
	{{ template "header" . }}
{{ end }}

import "context"

// Schema represents alternative db names
// for all ent models that can be passed
// at runtime.
type Schema struct {    
{{- range $.Nodes }}
	{{ .Name }} string
{{- end }}
{{- range .M2MModels }}
	{{ . }} string
{{- end }}
}

type ctxkey string

const key ctxkey = "schema"

// SetSchema sets the schema into the context.
func SetSchema(ctx context.Context, s Schema) context.Context {
	return context.WithValue(ctx, key, s)
}

// SchemaFromContext returns the embedded schema or
// an empty one if not found.
func SchemaFromContext(ctx context.Context) Schema {
	s, _ := ctx.Value(key).(Schema)
	return s
}

{{ end }}
