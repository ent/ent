{{/*
Copyright 2019-present Facebook Inc. All rights reserved.
This source code is licensed under the Apache 2.0 license found
in the LICENSE file in the root directory of this source tree.
*/}}

{{/* gotype: entgo.io/ent/entc/gen.Type*/}}

{{ define "dialect/dynamodb/meta/constants" }}
	// Table holds the table name of the {{ lower $.Name }} in the database.
	Table = "{{ $.Table }}"
	{{- range $e := $.Edges }}
		// {{ $e.TableConstant }} is the table that holds the {{ $e.Name }} relation/edge.
		{{- if $e.M2M }} The primary key declared below.{{ end }}
		{{ $e.TableConstant }} = "{{ $e.Rel.Table }}"
		{{- if ne $.Table $e.Type.Table }}
			// {{ $e.InverseTableConstant }} is the table name for the {{ $e.Type.Name }} entity.
			// It exists in this package in order to avoid circular dependency with the "{{ $e.Type.Package }}" package.
			{{ $e.InverseTableConstant }} = "{{ $e.Type.Table }}"
		{{- end }}
		{{- if not $e.M2M }}
			// {{ $e.AttributeConstant }} is the table column denoting the {{ $e.Name }} relation/edge.
			{{ $e.AttributeConstant }} = "{{ $e.Rel.Column }}"
		{{- end }}
	{{- end }}
{{ end }}

{{ define "dialect/dynamodb/meta/variables" }}
	{{ with $.NumM2M }}
		var (
			{{- range $_, $e := $.Edges }}
				{{- if $e.M2M }}
					// {{ $e.AttributeConstant }} and {{ $e.AttributeConstant }}2 are the collection keys denoting the
					// primary key for the {{ $e.Name }} relation (M2M).
					{{ $e.AttributeConstant }} = []string{"{{ index $e.Rel.Columns 0 }}", "{{ index $e.Rel.Columns 1 }}"}
				{{- end }}
			{{- end }}
		)
	{{ end }}
{{ end }}
